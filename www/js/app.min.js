angular.module("Spasey",["ionic","ngCordova"]).constant("AUTH_EVENTS",{notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}).constant("USER_ROLES",{dev:"dev_role",admin:"admin_role","public":"public_role",concierge:"concierge_role",resident:"resident_role"}).directive("toggleClass",function(){return{restrict:"A",link:function(e,t,n){t.bind("click",function(){t.toggleClass(n.toggleClass)})}}}).run(function(e){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),window.StatusBar&&StatusBar.styleDefault()})}).config(function(e,t,n){e.state("login",{url:"/login",templateUrl:"templates/login.html",controller:"LoginCtrl"}).state("register",{url:"/register",templateUrl:"templates/register.html",controller:"RegisterCtrl"}).state("dev",{url:"/dev",templateUrl:"templates/dev-map.html",controller:"DevCtrl",data:{authorizedRoles:[n.dev]}}).state("admin",{url:"/admin",templateUrl:"templates/admin-map.html",controller:"AdminCtrl",data:{authorizedRoles:[n.admin]}}).state("public",{url:"/public",templateUrl:"templates/base-map.html",controller:"PublicCtrl",data:{authorizedRoles:[n["public"]]}}).state("concierge",{url:"/concierge",templateUrl:"templates/concierge-map.html",controller:"CncrgCtrl",data:{authorizedRoles:[n.concierge]}}).state("resident",{url:"/resident",templateUrl:"templates/resident-map.html",controller:"ResCtrl",data:{authorizedRoles:[n.resident]}}).state("error",{url:"/error",templateUrl:"templates/error.html",controller:"ErrCtrl"}),t.otherwise(function(e,t){var n=e.get("$state");n.current.name&&"login"!==n.current.name?"register"===n.current.name?n.go("register"):"dev"===n.current.name?n.go("dev"):"admin"===n.current.name?n.go("admin"):"public"===n.current.name?n.go("public"):"concierge"===n.current.name?n.go("concierge"):"resident"===n.current.name?n.go("resident"):n.go("error"):n.go("login")})}).controller("AppCtrl",function(e,t,n,o,i,r,a,l){t.username=a.username(),t.$on(l.notAuthorized,function(e){i.alert({title:"UNAUTHORISED  ACCESS",template:"You are not allowed to access this resource.",okType:"button-assertive"})}),t.$on(l.notAuthenticated,function(e){a.logout(),n.go("login");i.alert({title:"SESSION LOST",template:"Sorry, Your session has expired, please login again.",okType:"button-dark"})}),t.setCurrentUsername=function(e){t.username=e},t.logout=function(){var t=e.defer();return o.toggleLeft(),r(function(){a.logout(),n.go("login"),t.resolve()},300),t.promise}}).run(function(e,t,n,o){e.$on("$stateChangeStart",function(i,r,a,l){if("data"in r&&"authorizedRoles"in r.data){var c=r.data.authorizedRoles;n.isAuthorized(c)||(i.preventDefault(),t.go(t.current,{},{reload:!0}),e.$broadcast(o.notAuthorized))}n.isAuthenticated()||"error"===r.name&&(i.preventDefault(),t.go("login"))})}).service("AuthService",function(e,t,n){function o(){var e=window.localStorage.getItem(c);e&&r(e)}function i(e){window.localStorage.setItem(c,e),r(e)}function r(e){s=e.split(".")[0],u=!0,l=e,"dev"==s&&(d=n.dev),"admin"==s&&(d=n.admin),"public"==s&&(d=n["public"]),"concierge"==s&&(d=n.concierge),"resident"==s&&(d=n.resident),t.defaults.headers.common["X-Auth-Token"]=e}function a(){l=void 0,s="",u=!1,t.defaults.headers.common["X-Auth-Token"]=void 0,window.localStorage.removeItem(c)}var l,c="yourTokenKey",s="",u=!1,d="",m=function(t,n){return e(function(e,o){"dev"==t&&"1"==n||"admin"==t&&"1"==n||"public"==t&&"1"==n||"concierge"==t&&"1"==n||"resident"==t&&"1"==n?(i(t+".yourServerToken"),e("Login success.")):o("Login Failed.")})},p=function(){a()},f=function(e){return angular.isArray(e)||(e=[e]),u&&-1!==e.indexOf(d)};return o(),{login:m,logout:p,isAuthorized:f,isAuthenticated:function(){return u},username:function(){return s},role:function(){return d}}}).factory("AuthInterceptor",function(e,t,n){return{responseError:function(o){return e.$broadcast({401:n.notAuthenticated,403:n.notAuthorized}[o.status],o),t.reject(o)}}}).config(function(e){e.interceptors.push("AuthInterceptor")}).controller("LoginCtrl",function(e,t,n,o){e.data={},e.login=function(i){o.login(i.username,i.password).then(function(n){t.go("dev",{},{reload:!0}),e.setCurrentUsername(i.username)},function(e){n.alert({title:"LOGIN FAILED",template:"Please check your credentials",okType:"button-assertive"})})}}).controller("RegisterCtrl",function(e,t,n){e.data={},e.register=function(e){console.log(e)}}).factory("Markers",function(e,t,n){var o="http://spasey-service.herokuapp.com";return{getMarkers:function(e){var n=angular.element(document.querySelector(".customLoader"));return n.addClass("show"),t.get(o+"/markers",{params:e}).then(function(e){return n.removeClass("show"),e})},createMarker:function(e){return n.show({template:'<ion-spinner icon="ripple"></ion-spinner>'}),t.post(o+"/markers",{marker:e}).then(function(e){n.hide()})},updateMarker:function(e){return n.show({template:'<ion-spinner icon="ripple"></ion-spinner>'}),t.put(o+"/markers/"+e.id,{marker:e}).then(function(e){n.hide()})},deleteMarker:function(e){return n.show({template:'<ion-spinner icon="ripple"></ion-spinner>'}),t["delete"](o+"/markers/"+e.id,{marker:e}).then(function(e){n.hide()})}}}).factory("ConnectivityMonitor",function(e,t){return{isOnline:function(){return ionic.Platform.isWebView()?t.isOnline():navigator.onLine},isOffline:function(){return ionic.Platform.isWebView()?!t.isOnline():!navigator.onLine}}}).factory("GoogleMaps",function(e,t,n,o,i,r,a){function l(){var t={timeout:1e4,enableHighAccuracy:!0};e.getCurrentPosition(t).then(function(e){E={lat:e.coords.latitude,lng:e.coords.longitude};var t=new google.maps.LatLng(V.lat,V.lng),n={center:t,zoom:16,zoomControl:!1,fullscreenControl:!0,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:[{featureType:"all",elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#000000"},{lightness:40}]},{featureType:"all",elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#000000"},{lightness:16}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#000000"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#000000"},{lightness:17},{weight:1.2}]},{featureType:"administrative",elementType:"labels.text",stylers:[{gamma:"1.00"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#7d8be9"}]},{featureType:"administrative.locality",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"administrative.neighborhood",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"administrative.land_parcel",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape",elementType:"all",stylers:[{visibility:"simplified"},{color:"#28292d"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#28292d"},{lightness:"0"}]},{featureType:"landscape.man_made",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"},{saturation:"0"}]},{featureType:"landscape.man_made",elementType:"geometry.stroke",stylers:[{visibility:"on"},{saturation:"0"},{gamma:"1"},{color:"#c4c8de"},{weight:"1"},{lightness:"0"}]},{featureType:"landscape.natural.landcover",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape.natural.terrain",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#28292d"},{lightness:"0"},{saturation:"0"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#e9d07d"},{visibility:"on"},{weight:"0.49"},{gamma:"1."}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#bcc0a7"},{weight:"1.00"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{weight:"1.10"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{weight:"0.01"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{weight:"1.00"},{lightness:"12"},{saturation:"-53"},{gamma:"0.91"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{weight:"0.01"}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#323029"},{lightness:"-6"},{visibility:"on"},{gamma:"1.98"},{weight:"0.65"},{saturation:"-19"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{visibility:"on"},{weight:"0.01"}]},{featureType:"transit",elementType:"geometry",stylers:[{lightness:19}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#28292d"},{lightness:"8"},{visibility:"on"}]}]};q=new google.maps.Map(document.getElementById("map"),n),google.maps.event.addListenerOnce(q,"idle",function(){m(),google.maps.event.addListener(q,"dragend",function(){m()}),google.maps.event.addListener(q,"zoom_changed",function(){m()}),c()}),M()},function(e){console.warn("Could not get location"),m()})}function c(){t.hide()}function s(){console.warn("map disabled"),t.show({template:"You must be connected to the Internet to view this map."})}function u(){t.show({template:"Loading Google Maps"}),window.mapInit=function(){l()};var e=document.createElement("script");e.type="text/javascript",e.id="googleMaps",B?e.src="http://maps.google.com/maps/api/js?key="+B+"&callback=mapInit":(console.warn("no API key found"),e.src="http://maps.google.com/maps/api/js?callback=mapInit"),document.body.appendChild(e)}function d(){console.log("checking if loaded"),"undefined"==typeof google||"undefined"==typeof google.maps?u():c()}function m(){var e=q.getCenter(),t=q.getBounds(),n=q.getZoom(),o={lat:e.lat(),lng:e.lng()},i={northeast:{lat:t.getNorthEast().lat(),lng:t.getNorthEast().lng()},southwest:{lat:t.getSouthWest().lat(),lng:t.getSouthWest().lng()}},a=f(o,i),l={centre:o,bounds:i,zoom:n,boundingRadius:a};r.getMarkers(l).then(function(e){function t(e){google.maps.Marker.apply(this,arguments),e.map_icon_label&&(this.MarkerLabel=new i({map:this.map,marker:this,text:e.map_icon_label}),this.MarkerLabel.bindTo("position",this,"position"))}var n="M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z",o=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e};o(t,google.maps.Marker),t.prototype.setMap=function(){google.maps.Marker.prototype.setMap.apply(this,arguments),this.MarkerLabel&&this.MarkerLabel.setMap.apply(this.MarkerLabel,arguments)};var i=function(e){var t=this;this.setValues(e),this.div=document.createElement("div"),this.div.className="map-icon-label",google.maps.event.addDomListener(this.div,"click",function(e){e.stopPropagation&&e.stopPropagation(),google.maps.event.trigger(t.marker,"click")})};i.prototype=new google.maps.OverlayView,i.prototype.onAdd=function(){var e=(this.getPanes().overlayImage.appendChild(this.div),this);this.listeners=[google.maps.event.addListener(this,"position_changed",function(){e.draw()}),google.maps.event.addListener(this,"text_changed",function(){e.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){e.draw()})]},i.prototype.onRemove=function(){this.div.parentNode.removeChild(this.div);for(var e=0,t=this.listeners.length;t>e;++e)google.maps.event.removeListener(this.listeners[e])},i.prototype.draw=function(){var e=this.getProjection(),t=e.fromLatLngToDivPixel(this.get("position")),n=this.div;this.div.innerHTML=this.get("text").toString(),n.style.zIndex=this.get("zIndex"),n.style.position="absolute",n.style.display="block",n.style.left=t.x-n.offsetWidth/2+"px",n.style.top=t.y-n.offsetHeight+"px"};for(var r=e.data.markers,a=0;a<r.length;a++){var l=r[a];if(!p(l.latitude,l.longitude)){var c=new google.maps.LatLng(l.latitude,l.longitude);if(J)var s=new t({map:q,icon:{path:n,fillcolor:"#FFC900",fillOpacity:.5,strokeColor:"#FFC900",strokeWeight:2},map_icon_label:'<span class="map-icon-label-ticker">'+l.counter+"</span>",position:c});else var s=new t({map:q,animation:google.maps.Animation.DROP,icon:{path:n,fillcolor:"#FFC900",fillOpacity:.5,strokeColor:"#FFC900",strokeWeight:2},map_icon_label:'<span class="map-icon-label-ticker">'+l.counter+"</span>",position:c});var u={lat:l.latitude,lng:l.longitude,marker:s};P.push(u),O.push(l),z(s,l)}}}).then(function(){return A()})}function p(e,t){for(var n=!1,o=P,i=0;i<o.length;i++)o[i].lat===e&&o[i].lng===t&&(n=!0);return n}function f(e,t){return g(e,t.northeast,"miles")}function g(e,t,n){var o={miles:3958.8,km:6371},i=o[n||"miles"],r=e.lat,a=e.lng,l=t.lat,c=t.lng,s=h(l-r),u=h(c-a),d=Math.sin(s/2)*Math.sin(s/2)+Math.cos(h(r))*Math.cos(h(l))*Math.sin(u/2)*Math.sin(u/2),m=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),p=i*m;return p}function h(e){return e*Math.PI/180}function y(){j=!1,X&&i(function(){W=!1,Z.removeClass("active"),K.removeClass("active"),$.addClass("active")},300)}function k(){$.removeClass("active")}function v(){j=!0,X&&(W=!0,$.removeClass("active"),K.removeClass("active"),Z.addClass("active"))}function C(){angular.element(document.querySelector(".map-icon-label-ticker.active")).removeClass("active"),Z.removeClass("active")}function b(){W=!0,$.removeClass("active"),Z.removeClass("active"),K.addClass("active")}function w(){angular.element(document.querySelector(".map-icon-label-ticker.active")).removeClass("active"),K.removeClass("active")}function T(){ionic.Platform.isWebView?(n.$on("$cordovaNetwork:online",function(e,t){d(),console.info("device online")}),n.$on("$cordovaNetwork:offline",function(e,t){s(),console.warn("device offline")})):(window.addEventListener("online",function(e){d(),console.log("browser online")},!1),window.addEventListener("offline",function(e){s(),console.log("browser offline")},!1))}function M(){X&&(console.warn("ADMIN"),google.maps.event.addListener(q,"click",function(e){U(e),y()})),Y&&(console.warn("BASIC"),U())}function A(){n.listCache=O}function U(e){if(e){var t=e.latLng.lat().toString(),o=e.latLng.lng().toString();H=[{capacity:"",counter:"",dictionary:"",latitude:t,longitude:o,points:"",roads:""}]}else H=[{capacity:"",counter:"",dictionary:"",latitude:"",longitude:"",points:"",roads:""}];n.newCache=H}function S(e){F={capacity:e.capacity,counter:e.counter,dictionary:e.dictionary,latitude:e.latitude,longitude:e.longitude,points:e.points,roads:e.roads,id:e.id},n.tempCache=F}function L(e){e?(j=!0,N=[{_capacity:e.capacity,capacity:e.capacity,_counter:e.counter,counter:e.counter,_dictionary:e.dictionary,dictionary:e.dictionary,latitude:e.latitude.toString(),longitude:e.longitude.toString(),_points:e.points,points:e.points,_roads:e.roads,roads:e.roads,_id:e.id,id:e.id}]):N=[{capacity:"",counter:"",dictionary:"",latitude:"",longitude:"",points:"",roads:"",id:""}],n.editCache=N}function D(e){e.counter<9&&N[0].counter++}function x(e){e.counter>0&&N[0].counter--}function z(e,t){google.maps.event.addListener(e,"click",function(){L(t),angular.element(document.querySelector(".map-icon-label-ticker.active")).removeClass("active"),_=angular.element(this.MarkerLabel.div.children[0]),_.addClass("active"),X?v():b()})}function I(){q.panTo(E)}function R(){for(var e=0;e<P.length;e++)P[e].marker.setMap(null);O=[],P=[],J=!0,m()}var _,E,P=[],O=[],N=[],H=[],F={},B=!1,q=null,V={lat:51.5060752,lng:-.0047033},$=angular.element(document.querySelector(".actibox-new")),Z=angular.element(document.querySelector(".actibox-edit")),K=angular.element(document.querySelector(".actibox-counter")),W=!1,Y=!0,X=!1,j=!1,J=!1;return{init:function(e){"undefined"!=typeof e&&(B=e),"undefined"==typeof google||"undefined"==typeof google.maps?a.isOnline()?u():(s(),console.warn("google is undefined"),console.warn("Google Maps SDK needs to be loaded")):a.isOnline()?(P=[],l(),c()):s(),T()},clickMap:function(){Y&&W?(b(),W=!1):X&&W?(v(),W=!1):X&&!W&&(y(),W=!1)},clickNewClose:function(){k()},clickEditClose:function(){C()},clickCounterClose:function(){w()},clickCounterUp:function(e){D(e)},clickCounterDown:function(e){x(e)},setCenter:function(){I()},listMarkers:function(){A()},newMarker:function(e){if(X){if(e)return S(e),r.createMarker(F).then(function(){R()});U()}},editMarker:function(e){X&&(e?L(e):L())},editOnce:function(){return j},updateMarker:function(e){return X&&e?(S(e),r.updateMarker(F).then(function(){R()})):void 0},updateCounter:function(e){return e?(S(e),r.updateMarker(F).then(function(){R()})):void 0},deleteMarker:function(e){return X&&e?(S(e),r.deleteMarker(F).then(function(){R()})):void 0},setAdmin:function(e){e?(Y=!1,X=!0):(Y=!0,X=!1),M()}}}).factory("Concierge",function(e,t,n){return{parkVehicle:function(){},releaseVehicle:function(){},postBox:function(){},messageChat:function(){}}}).controller("DevCtrl",function(e,t,n,o,i,r,a,l){ionic.Platform.ready(function(){l.init("AIzaSyDt1Hn4Nag4LRzZY-b6Jn0leKDc2ZMwXns"),o.fromTemplateUrl("templates/new.html",{scope:e,animation:"slide-in-down"}).then(function(t){e.modalC=t}),o.fromTemplateUrl("templates/admin-list.html",{scope:e}).then(function(t){e.modalR=t}),o.fromTemplateUrl("templates/edit.html",{scope:e,animation:"slide-in-down"}).then(function(t){e.modalUD=t}),o.fromTemplateUrl("templates/profile.html",{scope:e,animation:"slide-in-left"}).then(function(t){e.modalProfile=t}),o.fromTemplateUrl("templates/settings.html",{scope:e,animation:"slide-in-left"}).then(function(t){e.modalSettings=t}),o.fromTemplateUrl("templates/feedback.html",{scope:e,animation:"slide-in-left"}).then(function(t){e.modalFeedback=t}),o.fromTemplateUrl("templates/messages.html",{scope:e,animation:"slide-in-right"}).then(function(t){e.modalMessages=t}),o.fromTemplateUrl("templates/inbox.html",{scope:e,animation:"slide-in-right"}).then(function(t){e.modalInbox=t}),o.fromTemplateUrl("templates/postbox.html",{scope:e,animation:"slide-in-right"}).then(function(t){e.modalPostbox=t}),o.fromTemplateUrl("templates/postal.html",{scope:e,animation:"slide-in-right"}).then(function(t){e.modalPostal=t}),o.fromTemplateUrl("templates/valet.html",{scope:e,animation:"slide-in-right"}).then(function(t){e.modalValet=t}),o.fromTemplateUrl("templates/history.html",{scope:e,animation:"slide-in-left"}).then(function(t){e.modalHistory=t}),e.empty=!0,e.clickMap=function(){l.clickMap(),l.editOnce()&&(e.empty=!1)},e.clickNewHide=function(){l.clickNewClose()},e.clickEditHide=function(){l.clickEditClose()},e.clickCounterHide=function(){l.clickCounterClose()},e.setCenter=function(){l.setCenter()},e.listMarkers=function(){l.listMarkers()},e.listItem=function(){},e.addMarker=function(t){l.newMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker added",okType:"button-dark"});t.then(function(t){t&&(l.clickNewClose(),e.modalC.hide(),l.newMarker())})})},e.editMarker=function(t){e.empty=!1,l.editMarker(t),r.closeOptionButtons(),e.modalR.hide().then(function(){e.modalUD.show()})},e.updateMarker=function(t){e.empty=!0,l.updateMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker updated",okType:"button-dark"});t.then(function(t){t&&(l.clickEditClose(),e.modalUD.hide(),l.editMarker())})})},e.deleteMarker=function(t){var n=i.confirm({title:"Confirm",template:"Are you sure you want to delete this marker?",okText:"Delete",okType:"button-assertive"});n.then(function(n){n&&l.deleteMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker deleted",okType:"button-dark"});t.then(function(t){t&&(l.clickEditClose(),r.closeOptionButtons(),e.modalR.hide())})})})},e.updateCounter=function(t){e.empty=!0,l.updateCounter(t).then(function(){var e=i.alert({title:"Thank you",template:"Counter updated",okType:"button-dark"});e.then(function(e){e&&l.clickCounterClose()})})},e.counterUp=function(e){l.clickCounterUp(e)},e.counterDown=function(e){l.clickCounterDown(e)},e.setAdmin=function(e){l.clickNewClose(),l.clickEditClose(),l.clickCounterClose(),r.closeOptionButtons(),1==e?l.setAdmin(e):l.setAdmin()};var t=!1;e.basic=!0,e.toggleAdmin=function(n){return t?(t=!1,e.basic=!0,angular.element(document.querySelector(".btn-list")).addClass("basic"),e.setAdmin()):(e.setAdmin(n),t=!0,angular.element(document.querySelector(".btn-list")).removeClass("basic"),void(e.basic=!1))},e.goProfile=function(){e.modalProfile.show()},e.goSettings=function(){e.modalSettings.show()},e.goFeedback=function(){e.modalFeedback.show()},e.goPostbox=function(){e.modalPostbox.show()},e.goInbox=function(){e.modalInbox.show()},e.goMessages=function(){e.modalMessages.show()},e.goPostal=function(){e.modalPostal.show()},e.goValet=function(){e.modalValet.show()}})}).controller("AdminCtrl",function(e,t,n,o,i,r,a){console.warn("Admin"),a.init("AIzaSyDt1Hn4Nag4LRzZY-b6Jn0leKDc2ZMwXns"),o.fromTemplateUrl("templates/new.html",{scope:e}).then(function(t){e.modalC=t,a.newMarker()}),o.fromTemplateUrl("templates/admin-list.html",{scope:e}).then(function(t){e.modalR=t}),o.fromTemplateUrl("templates/edit.html",{scope:e}).then(function(t){e.modalUD=t}),e.empty=!0,e.clickMap=function(){a.clickMap(),a.editOnce()&&(e.empty=!1)},e.clickNewHide=function(){a.clickNewClose()},e.clickEditHide=function(){a.clickEditClose()},e.clickCounterHide=function(){a.clickCounterClose()},e.setCenter=function(){a.setCenter()},e.listMarkers=function(){a.listMarkers()},e.addMarker=function(t){a.newMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker added",okType:"button-dark"});t.then(function(t){t&&(a.clickNewClose(),e.modalC.hide(),a.newMarker())})})},e.editMarker=function(t){e.empty=!1,a.editMarker(t),r.closeOptionButtons(),e.modalUD.show(),e.modalR.hide()},e.updateMarker=function(t){e.empty=!0,a.updateMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker updated",okType:"button-dark"});t.then(function(t){t&&(a.clickEditClose(),e.modalUD.hide(),a.editMarker())})})},e.deleteMarker=function(t){var n=i.confirm({title:"Confirm",template:"Are you sure you want to delete this marker?",okText:"Delete",okType:"button-assertive"});n.then(function(n){n&&a.deleteMarker(t).then(function(){var t=i.alert({title:"Thank you",template:"Marker deleted",okType:"button-dark"});t.then(function(t){t&&(a.clickEditClose(),r.closeOptionButtons(),e.modalR.hide())})})})},e.updateCounter=function(t){e.empty=!0,a.updateCounter(t).then(function(){var e=i.alert({title:"Thank you",template:"Counter updated",okType:"button-dark"});e.then(function(e){e&&a.clickCounterClose()})})},e.counterUp=function(e){a.clickCounterUp(e)},e.counterDown=function(e){a.clickCounterDown(e)},e.setAdmin=function(e){a.clickNewClose(),a.clickEditClose(),a.clickCounterClose(),1==e?a.setAdmin(e):a.setAdmin()};var l=!1;e.basic=!0,e.toggleAdmin=function(t){return l?(l=!1,e.basic=!0,angular.element(document.querySelector(".btn-list")).addClass("basic"),e.setAdmin()):(e.setAdmin(t),l=!0,angular.element(document.querySelector(".btn-list")).removeClass("basic"),void(e.basic=!1))}}).controller("UserCtrl",function(e,t,n,o,i,r,a){console.warn("User"),a.init("AIzaSyDt1Hn4Nag4LRzZY-b6Jn0leKDc2ZMwXns"),o.fromTemplateUrl("templates/base-list.html",{scope:e}).then(function(t){e.modalR=t}),e.clickCounterHide=function(){a.clickCounterClose()},e.setCenter=function(){a.setCenter()},e.listMarkers=function(){a.listMarkers()},e.clickMap=function(){a.clickMap()},e.updateCounter=function(e){a.updateCounter(e).then(function(){var e=i.alert({title:"Thank you",template:"Counter updated",okType:"button-dark"});e.then(function(e){e&&a.clickCounterClose()})})},e.counterUp=function(e){a.clickCounterUp(e)},e.counterDown=function(e){a.clickCounterDown(e)}}).controller("CncrgCtrl",function(e,t,n,o,i,r,a){console.warn("Concierge"),a.init("AIzaSyDt1Hn4Nag4LRzZY-b6Jn0leKDc2ZMwXns"),o.fromTemplateUrl("templates/base-list.html",{scope:e}).then(function(t){e.modalR=t}),e.clickCounterHide=function(){a.clickCounterClose()},e.setCenter=function(){a.setCenter()},e.listMarkers=function(){a.listMarkers()},e.clickMap=function(){a.clickMap()},e.updateCounter=function(e){a.updateCounter(e).then(function(){var e=i.alert({title:"Thank you",template:"Counter updated",okType:"button-dark"});e.then(function(e){e&&a.clickCounterClose()})})},e.counterUp=function(e){a.clickCounterUp(e)},e.counterDown=function(e){a.clickCounterDown(e)}}).controller("ResCtrl",function(e,t,n,o,i,r,a){console.warn("Resident"),a.init("AIzaSyDt1Hn4Nag4LRzZY-b6Jn0leKDc2ZMwXns"),o.fromTemplateUrl("templates/base-list.html",{scope:e}).then(function(t){e.modalR=t}),e.clickCounterHide=function(){a.clickCounterClose()},e.setCenter=function(){a.setCenter()},e.listMarkers=function(){a.listMarkers()},e.clickMap=function(){a.clickMap()},e.updateCounter=function(e){a.updateCounter(e).then(function(){var e=i.alert({title:"Thank you",template:"Counter updated",okType:"button-dark"});e.then(function(e){e&&a.clickCounterClose()})})},e.counterUp=function(e){a.clickCounterUp(e)},e.counterDown=function(e){a.clickCounterDown(e)}}).controller("ProfileCtrl",function(e,t){e.editActive=!1;var n={username:"dev@spasey.com",password:"zaxscdvf"};e.profile={username:"dev@spasey.com",password:"zaxscdvf"},e.unchanged=function(){return e.profile.username===n.username&&e.profile.password===n.password?!0:!1},e.$on("modal.hidden",function(){t(function(){e.editActive=!1,e.profile={username:"dev@spasey.com",password:"zaxscdvf"},e.click=!1,e.button=!1},300)}),e.update=function(e){console.log(e)}}).controller("SettingsCtrl",function(e){}).controller("FeedbackCtrl",function(e){e.feedback={username:"dev@spasey.com",message:""},e.send=function(){console.log(e.feedback.message),e.feedback.message=""}}).controller("ValetCtrl",function(e,t){}).controller("PostboxCtrl",function(e,t){}).controller("MessagesCtrl",function(e,t){}).controller("ErrCtrl",function(e,t){console.warn("WTF"),e.goBack=function(){t.goBack()}});